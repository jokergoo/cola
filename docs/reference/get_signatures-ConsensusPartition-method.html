<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get signature rows — get_signatures-ConsensusPartition-method • cola</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Get signature rows — get_signatures-ConsensusPartition-method"><meta property="og:description" content="Get signature rows"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cola</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Standard consensus partitioning</li>
    <li>
      <a href="../articles/cola_quick.html">A Quick Start of Using cola Package</a>
    </li>
    <li>
      <a href="../articles/cola_general.html">A Framework for Consensus Partitioning</a>
    </li>
    <li>
      <a href="../articles/functional_enrichment.html">Automatic Functional Enrichment on Signature genes</a>
    </li>
    <li>
      <a href="../articles/predict.html">Predict Classes for New Samples</a>
    </li>
    <li>
      <a href="../articles/work_with_big_datasets.html">Work with Big Datasets</a>
    </li>
    <li>
      <a href="../articles/compare_partitions.html">Compare Partitions</a>
    </li>
    <li>
      <a href="../articles/ATC_methods.html">ATC - More Forms</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Hierarchical partitioning</li>
    <li>
      <a href="../articles/hierarchical.html">Hierarchical consensus partitioning</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Other examples</li>
    <li>
      <a href="../articles/AML.html">Re-analyze an AML proteomics dataset</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">On public datasets</li>
    <li>
      <a href="../articles/examples.html">Applications on public datasets</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Supplementary files</li>
    <li>
      <a href="https://jokergoo.github.io/cola_supplementary/" class="external-link">Supplementary files for cola NAR paper</a>
    </li>
    <li>
      <a href="https://cola-rh.github.io/supplementary/" class="external-link">Supplementary files for cola BIB paper</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jokergoo/cola/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get signature rows</h1>
    
    <div class="hidden name"><code>get_signatures-ConsensusPartition-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Get signature rows</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for ConsensusPartition</span></span>
<span><span class="fu"><a href="get_signatures-dispatch.html">get_signatures</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">k</span>,</span>
<span>    col <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">scale_rows</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>    silhouette_cutoff <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>    fdr_cutoff <span class="op">=</span> <span class="va">cola_opt</span><span class="op">$</span><span class="va">fdr_cutoff</span>,</span>
<span>    top_signatures <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    group_diff <span class="op">=</span> <span class="va">cola_opt</span><span class="op">$</span><span class="va">group_diff</span>,</span>
<span>    scale_rows <span class="op">=</span> <span class="va">object</span><span class="op">@</span><span class="va">scale_rows</span>, .scale_mean <span class="op">=</span> <span class="cn">NULL</span>, .scale_sd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    row_km <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    diff_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ftest"</span>, <span class="st">"ttest"</span>, <span class="st">"samr"</span>, <span class="st">"pamr"</span>, <span class="st">"one_vs_others"</span>, <span class="st">"uniquely_high_in_one_group"</span><span class="op">)</span>,</span>
<span>    anno <span class="op">=</span> <span class="fu"><a href="get_anno-dispatch.html">get_anno</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>    anno_col <span class="op">=</span> <span class="fu"><a href="get_anno_col-dispatch.html">get_anno_col</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>    internal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    show_column_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    column_names_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    use_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    plot <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, seed <span class="op">=</span> <span class="fl">888</span>,</span>
<span>    left_annotation <span class="op">=</span> <span class="cn">NULL</span>, right_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    simplify <span class="op">=</span> <span class="cn">FALSE</span>, prefix <span class="op">=</span> <span class="st">""</span>, enforce <span class="op">=</span> <span class="cn">FALSE</span>, hash <span class="op">=</span> <span class="cn">NULL</span>, from_hc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>A <code><a href="ConsensusPartition-class.html">ConsensusPartition-class</a></code> object.</p></dd>

  <dt>k</dt>
<dd><p>Number of subgroups.</p></dd>

  <dt>col</dt>
<dd><p>Colors for the main heatmap.</p></dd>

  <dt>silhouette_cutoff</dt>
<dd><p>Cutoff for silhouette scores. Samples with values  less than it are not used for finding signature rows. For selecting a  proper silhouette cutoff, please refer to <a href="https://www.stat.berkeley.edu/~s133/Cluster2a.html#tth_tAb1." class="external-link">https://www.stat.berkeley.edu/~s133/Cluster2a.html#tth_tAb1.</a></p></dd>

  <dt>fdr_cutoff</dt>
<dd><p>Cutoff for FDR of the difference test between subgroups.</p></dd>

  <dt>top_signatures</dt>
<dd><p>Top signatures with most significant fdr. Note since fdr might be same for multiple rows, the final number of signatures might not be exactly the same as the one that has been set.</p></dd>

  <dt>group_diff</dt>
<dd><p>Cutoff for the maximal difference between group means.</p></dd>

  <dt>scale_rows</dt>
<dd><p>Whether apply row scaling when making the heatmap.</p></dd>

  <dt>.scale_mean</dt>
<dd><p>Internally used.</p></dd>

  <dt>.scale_sd</dt>
<dd><p>Internally used.</p></dd>

  <dt>row_km</dt>
<dd><p>Number of groups for performing k-means clustering on rows. By default it is automatically selected.</p></dd>

  <dt>diff_method</dt>
<dd><p>Methods to get rows which are significantly different between subgroups, see 'Details' section.</p></dd>

  <dt>anno</dt>
<dd><p>A data frame of annotations for the original matrix columns.  By default it uses the annotations specified in <code><a href="consensus_partition.html">consensus_partition</a></code> or <code><a href="run_all_consensus_partition_methods.html">run_all_consensus_partition_methods</a></code>.</p></dd>

  <dt>anno_col</dt>
<dd><p>A list of colors (color is defined as a named vector) for the annotations. If <code>anno</code> is a data frame, <code>anno_col</code> should be a named list where names correspond to the column names in <code>anno</code>.</p></dd>

  <dt>internal</dt>
<dd><p>Used internally.</p></dd>

  <dt>show_row_dend</dt>
<dd><p>Whether show row dendrogram.</p></dd>

  <dt>show_column_names</dt>
<dd><p>Whether show column names in the heatmap.</p></dd>

  <dt>column_names_gp</dt>
<dd><p>Graphics parameters for column names.</p></dd>

  <dt>use_raster</dt>
<dd><p>Internally used.</p></dd>

  <dt>plot</dt>
<dd><p>Whether to make the plot.</p></dd>

  <dt>verbose</dt>
<dd><p>Whether to print messages.</p></dd>

  <dt>seed</dt>
<dd><p>Random seed.</p></dd>

  <dt>left_annotation</dt>
<dd><p>Annotation put on the left of the heatmap. It should be a <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation-class.html" class="external-link">HeatmapAnnotation-class</a></code> object.  The number of items should be the same as the number of the original matrix rows. The subsetting to the significant  rows are automatically performed on the annotation object.</p></dd>

  <dt>right_annotation</dt>
<dd><p>Annotation put on the right of the heatmap. Same format as <code>left_annotation</code>.</p></dd>

  <dt>simplify</dt>
<dd><p>Only used internally.</p></dd>

  <dt>prefix</dt>
<dd><p>Only used internally.</p></dd>

  <dt>enforce</dt>
<dd><p>The analysis is cached by default, so that the analysis with the same input will be automatically extracted without rerunning them. Set <code>enforce</code> to <code>TRUE</code> to enforce the funtion to re-perform the analysis.</p></dd>

  <dt>hash</dt>
<dd><p>Userd internally.</p></dd>

  <dt>from_hc</dt>
<dd><p>Is the <code><a href="ConsensusPartition-class.html">ConsensusPartition-class</a></code> object a node of a <code><a href="HierarchicalPartition-class.html">HierarchicalPartition</a></code> object?</p></dd>

  <dt>...</dt>
<dd><p>Other arguments.</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Basically the function applies statistical test for the difference in subgroups for every
row. There are following methods which test significance of the difference:</p>
<dl><dt>ttest</dt>
<dd><p>First it looks for the subgroup with highest mean value, compare to each of the  other subgroups with t-test and take the maximum p-value. Second it looks for the subgroup with lowest mean value, compare to each of the other subgroups again with t-test and take the maximum p-values. Later for these two list of p-values take the minimal p-value as the final p-value.</p></dd>

  <dt>samr/pamr</dt>
<dd><p>use SAM (from samr package)/PAM (from pamr package) method to find significantly different rows between subgroups.</p></dd>

  <dt>Ftest</dt>
<dd><p>use F-test to find significantly different rows between subgroups.</p></dd>

  <dt>one_vs_others</dt>
<dd><p>For each subgroup i in each row, it uses t-test to compare samples in current  subgroup to all other samples, denoted as p_i. The p-value for current row is selected as min(p_i).</p></dd>

  <dt>uniquely_high_in_one_group</dt>
<dd><p>The signatures are defined as, if they are uniquely up-regulated in subgroup A, then it must fit following criterions: 1. in a two-group t-test of A ~ other_merged_groups, the statistic must be &gt; 0 (high in group A) and p-value must be significant,  and 2. for other groups (excluding A), t-test in every pair of groups should not be significant.</p></dd>


</dl><p><code>diff_method</code> can also be a self-defined function. The function needs two arguments which are the matrix for the analysis
and the predicted classes. The function should returns a vector of FDR from the difference test.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with more than two columns:</p>


<dl><dt><code>which_row</code>:</dt>
<dd><p>row index corresponding to the original matrix.</p></dd>

  <dt><code>fdr</code>:</dt>
<dd><p>the FDR.</p></dd>

  <dt><code>km</code>:</dt>
<dd><p>the k-means groups if <code>row_km</code> is set.</p></dd>

  <dt>other_columns:</dt>
<dd><p>the mean value (depending rows are scaled or not) in each subgroup.</p></dd>


</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Zuguang Gu &lt;z.gu@dkfz.de&gt;</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">golub_cola</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="va">golub_cola</span><span class="op">[</span><span class="st">"ATC"</span>, <span class="st">"skmeans"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tb</span> <span class="op">=</span> <span class="fu"><a href="get_signatures-dispatch.html">get_signatures</a></span><span class="op">(</span><span class="va">res</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * 72/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * cache hash: 87c63a8cabc898f97a024514962787f7 (seed 888).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * calculating row difference between subgroups by Ftest.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * split rows into 4 groups by k-means clustering.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * 2058 signatures (50.0%) under fdr &lt; 0.05, group_diff &gt; 0.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - randomly sample 2000 signatures.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * making heatmaps for signatures.</span>
<span class="r-plt img"><img src="get_signatures-ConsensusPartition-method-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   which_row          fdr     p_value   mean_1   mean_2   mean_3 group_diff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         2 0.0005480204 0.000102654 1.747716 2.081334 2.004512  0.3336177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         3 0.0114427741 0.004095045 2.182303 2.251489 2.397769  0.2154661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        11 0.0035593360 0.001009916 2.342387 2.529442 2.380858  0.1870552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        12 0.0143153879 0.005335230 2.384353 2.549453 2.301059  0.2483942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        13 0.0201369424 0.008253407 2.737212 2.840578 3.423688  0.6864764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        14 0.0157851334 0.006036395 3.244110 3.371635 3.638171  0.3940607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   scaled_mean_1 scaled_mean_2 scaled_mean_3 group_diff_scaled km</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    -0.4997955    0.53497043     0.2966968         1.0347659  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    -0.3093980    0.02013769     0.7168734         1.0262713  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    -0.3509730    0.58915719    -0.1576207         0.9401302  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    -0.1531394    0.49786781    -0.4815776         0.9794454  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    -0.2321462   -0.08925855     0.7167982         0.9489443  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    -0.2998939    0.02113042     0.6920903         0.9919842  2</span>
<span class="r-in"><span><span class="fu"><a href="get_signatures-dispatch.html">get_signatures</a></span><span class="op">(</span><span class="va">res</span>, k <span class="op">=</span> <span class="fl">3</span>, top_signatures <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * 72/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * cache hash: 9e0a60297e9e338085d22adb55750347 (seed 888).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * calculating row difference between subgroups by Ftest.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * split rows into 3 groups by k-means clustering.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * 101 signatures (2.5%) with most significant fdr, group_diff &gt; 0.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * making heatmaps for signatures.</span>
<span class="r-plt img"><img src="get_signatures-ConsensusPartition-method-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  <style>nav[data-toggle='toc'] .nav .nav {display: block;}</style></body></html>

